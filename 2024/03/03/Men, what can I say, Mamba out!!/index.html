

<!DOCTYPE html>
<html lang="en" color-mode=light>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Men, what can I say, Mamba out!!ğŸğŸšğŸ”¥ - Avidya</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />
  
  <meta name="description" content="
ãƒãƒ³ãƒãƒ¡ãƒ³ã‚¿ãƒªãƒ†ã‚£ã¨ã¯ã€ç­”ãˆã‚’è¦‹ã¤ã‘å‡ºã™ãŸã‚ã®çµ‚ã‚ã‚Š...">
  <meta name="author" content="Kou">
  <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
    
<link rel="stylesheet" href="https://at.alicdn.com/t/font_1445822_p6ry5n7lrr.css">

  

  
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
    
      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/foundation.min.css" name="highlight-style" mode="light">

      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="dark">

      
  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      isHome: false,
      fancybox: true,
      pjax: false,
      loading: {
        gif: '/images/theme/loading.gif',
        lottie: ''
      },
      lazyload: {
        enable: true,
        only_post: 'false',
        loading: {
          gif: '/images/theme/loading.gif',
          lottie: ''
        }
      },
      donate: {
        enable: false,
        alipay: 'https://pic.izhaoo.com/alipay.jpg',
        wechat: 'https://pic.izhaoo.com/wechat.jpg'
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        always_show: false
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: false
      },
      preview: {
        background: {
          default: '',
          api: ''
        },
        motto: {
          default: 'ã‚‚ã—ã‚‚åƒ•ãŒä¸»äººå…¬ãªã‚‰ã€åƒ•ã¯äººã®å¿ƒãŒè¦‹ãˆã¦',
          typing: true,
          api: '',
          data_contents: '["data","content"]'
        },
      },
      qrcode: {
        enable: false,
        type: 'url',
        image: 'https://pic.izhaoo.com/weapp-code.jpg',
      },
      toc: {
        enable: true
      },
      scrollbar: {
        type: 'default'
      },
      notification: {
        enable: false,
        delay: 4500,
        list: '',
        page_white_list: '',
        page_black_list: ''
      },
      search: {
        enable: false,
        path: ''
      }
    }
  </script>

  

  

<meta name="generator" content="Hexo 6.3.0"></head>

<body class="lock-screen">
  <div class="loading" id="loading"></div>
  
    


  <nav class="navbar">
    <div class="left">
      
        <i class="iconfont iconhome j-navbar-back-home"></i>
      
      
      
        <i class="iconfont iconmoono" id="color-toggle" color-toggle="light"></i>
      
      
    </div>
    <div class="center">Men, what can I say, Mamba out!!ğŸğŸšğŸ”¥</div>
    <div class="right">
      <i class="iconfont iconmenu j-navbar-menu"></i>
    </div>
    
  </nav>

  
  

<nav class="menu">
  <div class="menu-container">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content"><li class="menu-item">
        <a href="/ " class="underline "> home</a>
      </li><li class="menu-item">
        <a href="/archives/ " class="underline "> archives</a>
      </li><li class="menu-item">
        <a href="/about/ " class="underline "> about</a>
      </li></ul>
    
  </div>
</nav>
  <main id="main">
  <div class="article-wrap">
    <div class="row container">
      <div class="col-xl-3"></div>
      <div class="col-xl-6"><article class="article">
  <div class="wrap">
    <section class="head">
  <img   class="lazyload" data-original="/images%5Ctheme%5Cmaxresdefault.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">Men, what can I say, Mamba out!!ğŸğŸšğŸ”¥</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>March 03, 2024</span>
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>2459</span>
    </div>
  </div>
</section>
    <section class="main">
      <section class="content">
        
        <blockquote>
<p>ãƒãƒ³ãƒãƒ¡ãƒ³ã‚¿ãƒªãƒ†ã‚£ã¨ã¯ã€ç­”ãˆã‚’è¦‹ã¤ã‘å‡ºã™ãŸã‚ã®çµ‚ã‚ã‚Šãªãå†’é™ºã€‚<br>ã‚‚ã£ã¨ä¸Šé”ã—ãŸã„ã€ã‚‚ã£ã¨çŸ¥ã‚ŠãŸã„ã¨ã„ã†ç„¡é™ã®å¥½å¥‡å¿ƒã€‚<br>ãƒãƒ³ãƒãƒ¡ãƒ³ã‚¿ãƒªãƒ†ã‚£ã¨ã¯ã€çµæœ«ã«ã“ã ã‚ã‚‰ãšã«ã¨ã«ã‹ãé€²ã¿ã€æˆ¦ã†äº‹ã€‚<br>äººã‹ã‚‰ä½•ã¨è¨€ã‚ã‚Œã‚‹ã‹ã€èª°ã‹ã«å¤±æœ›ã•ã‚Œã‚‹ã®ã§ã¯ãªã„ã‹ã€ãã‚“ãªã“ã¨ã¯ä¸€åˆ‡æ°—ã«ã›ãšã€ãã®ç¬é–“ã ã‘ã«ç¥çµŒã‚’æ³¨ãã€‚<br>ãã‚ŒãŒãƒãƒ³ãƒãƒ¡ãƒ³ã‚¿ãƒªãƒ†ã‚£ã ã€‚<br><a target="_blank" rel="noopener" href="https://github.com/state-spaces/mamba">Mamba</a> is really discussed recently since its outstanding performance compared to Transformer and used for LLM. So, what did it do to acheve this?<br>This model is inspired by both CNN and RNN model which means that it supports parallel computation and could deal with long-sequence input well.<br><img   class="lazyload" data-original="/images%5Ctheme%5Cmamba-1.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><br>In this picture, $h_{t-1}$ and $h_t$ is used to describe the states at different time, the idea from RNN.  $B_t$, $A$, $C_t$ and $d_t$ is designed as something like $y &#x3D; \omega x + b$, a classical part in neural network.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> mamba_ssm <span class="hljs-keyword">import</span> Mamba<br><br>batch, length, dim = <span class="hljs-number">2</span>, <span class="hljs-number">64</span>, <span class="hljs-number">16</span><br>x = torch.randn(batch, length, dim).to(<span class="hljs-string">&quot;cuda&quot;</span>)<br>model = Mamba(<br>    <span class="hljs-comment"># This module uses roughly 3 * expand * d_model^2 parameters</span><br>    d_model=dim, <span class="hljs-comment"># Model dimension d_model</span><br>    d_state=<span class="hljs-number">16</span>,  <span class="hljs-comment"># SSM state expansion factor</span><br>    d_conv=<span class="hljs-number">4</span>,    <span class="hljs-comment"># Local convolution width</span><br>    expand=<span class="hljs-number">2</span>,    <span class="hljs-comment"># Block expansion factor</span><br>).to(<span class="hljs-string">&quot;cuda&quot;</span>)<br>y = model(x)<br><span class="hljs-built_in">print</span>(y)<br></code></pre></td></tr></table></figure>
<p>This algorithm, like other LLM models, simply stacks multiple layers of Mamba to form a standard LLM, but there two types of Mamba can be selected, S4 or S6.<br><img   class="lazyload" data-original="/images%5Ctheme%5Cmamba-2.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><br>Regardless of the types of Mamba, the method to compute SSM is the same.<br><img   class="lazyload" data-original="/images%5Ctheme%5Cmamba-3.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><br>The main difference between S4 and S6 is that S6 uses the following method to compute $B$, $C$ and $d\delta$. S6 is calculated by linear function, while S4 is directly computed through parameter calculations. In fact, S6 involves adding an extra layer of mapping to establish a connection between the parameter matrix and the input, thereby achieving the effect of dynamic parameter changes with input.<br>However, now a problem arises: since the parameters change with input, the model becomes a time-varying system, and the trick of precomputing convolution kernels and then using convolution for parallel computation can no longer be employed. To avoid complete iterative computation, the authors employ three tricks for acceleration: Kernel Fusion, Parallel Scan, and Recomputation.<br>Codes in</p>
<blockquote>
<p>mamba_ssm&#x2F;modules&#x2F;mamba_simple.py<br>mamba_ssm&#x2F;models&#x2F;mixer_seq_simple.py<br>mamba_ssm&#x2F;ops&#x2F;selective_scan_interface.py</p>
</blockquote>
<p>In recent years, there are several models which claimed to rival or outperform the Transformer, but Mamba is a rare work that has been followed very quickly. It might be a promising model.</p>

      </section>
      <section class="extra">
        
          
        
        
        
        
  <nav class="nav">
    <a></a>
    <a href="/2024/02/07/LLM%E3%82%A8%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%B3%E3%83%88%E3%81%AE%E7%8F%BE%E7%8A%B6%E3%80%81%E3%81%9D%E3%81%97%E3%81%A6%E6%9C%AA%E6%9D%A5/">LLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç¾çŠ¶ã€ãã—ã¦æœªæ¥<i class="iconfont iconright"></i></a>
  </nav>

      </section>
      
    </section>
  </div>
</article></div>
      <div class="col-xl-3">
        
          
  <aside class="toc-wrap">
    <h3 class="toc-title">Index</h3>
    
  </aside>

        
      </div>
    </div>
  </div>
</main>
  

  <footer class="footer">
    <div class="footer-social"><a href="mailto:izhaoo@163.com " target="_blank"
  class="footer-social-item" onMouseOver="this.style.color=#FF3B00"
  onMouseOut="this.style.color='#33333D'">
  <i class="iconfont  iconmail"></i>
  </a></div>
    
  </footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
  
  
    
<script src="/js/color-mode.js"></script>

  
  
</body>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>





  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>




  
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>








<script src="/js/utils.js"></script>
<script src="/js/script.js"></script>







  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>












</html>